function updateItem(e){console.log(e),$("#js-"+e.name+"-status").text(e.status_str),d=new Date(e.start),$("#js-"+e.name+"-start").text(d.toLocaleTimeString("en-US")),d=new Date(e.end),$("#js-"+e.name+"-end").text(d.toLocaleTimeString("en-US")),panel=$("#js-"+e.name+"-panel"),offbutton=panel.find(".btn-off"),offbutton.data("id",e.id),offbutton.find(".glyphicon-refresh-animate").fadeOut("slow"),onbutton=panel.find(".btn-on"),onbutton.data("id",e.id),onbutton.find(".glyphicon-refresh-animate").fadeOut("slow"),e.status?(panel.removeClass("panel-off"),offbutton.removeClass("disabled"),panel.addClass("panel-on"),onbutton.addClass("disabled")):(panel.removeClass("panel-on"),onbutton.removeClass("disabled"),panel.addClass("panel-off"),offbutton.addClass("disabled"))}function updateError(e,a,n){console.log(e),message=e.responseJSON?e.responseJSON.message:n,$("#js-alert-message").append("<br/>"+message),$(".alert").fadeIn("slow")}function makeRequestToUpdate(e){e.preventDefault(),$(e.toElement).blur(),$(e.toElement).find(".glyphicon-refresh-animate").fadeIn("slow"),$(e.toElement).addClass("disabled"),$.when($.ajax({url:"update/id/"+$(e.toElement).data("id")+"/",data:"status="+$(e.toElement).data("status-value"),type:"POST",success:updateItem,error:updateError}))}function toggleVideo(e){$("#js-video-icon").hasClass("glyphicon-menu-right")?($("#js-video-icon").removeClass("glyphicon-menu-right").addClass("glyphicon-menu-down"),$("#js-video").fadeIn("slow")):($("#js-video-icon").removeClass("glyphicon-menu-down").addClass("glyphicon-menu-right"),$("#js-video").fadeOut("fast"))}$(document).ready(function(){$("a[data-status-value]").click(makeRequestToUpdate),$("#js-toggle-video").click(toggleVideo),$(document).ready(function(){$(".navbar-nav .dropdown-menu li a").click(function(e){$(".navbar-collapse").collapse("hide")})}),$.when($.getJSON("info/light/","",updateItem).fail(updateError),$.getJSON("info/door/","",updateItem).fail(updateError)).fail(function(){$(".glyphicon-refresh-animate").removeClass("glyphicon-refresh-animate").addClass("glyphicon-exclamation-sign")})});